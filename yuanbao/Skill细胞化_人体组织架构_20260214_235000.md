# Skill细胞化 - 人体组织架构

## 核心理念

将系统架构类比人体组织：

| 人体组织 | 系统映射 | 说明 |
|----------|----------|------|
| **细胞** | Skill | 最小功能单元，可独立运行 |
| **组织** | Agent | 多个Skill协作完成特定任务 |
| **器官** | 分类/模块 | 同类Agent聚合形成功能模块 |
| **经络** | 运行时 | 数据和控制流的传递通道 |
| **穴位** | Agently接入点 | 外部系统交互的接口节点 |

---

## Skill细胞结构升级

### 标准Skill字段

```yaml
skill:
  # 基础信息
  name: "Skill名称"
  description: "简短描述"
  
  # 功能定义
  functionality:
    - "功能点1"
    - "功能点2"
  
  # 资源依赖
  resources:
    scripts:
      - "script1.py"
      - "script2.js"
    data:
      - "model.pkl"
      - "config.json"
    
  # ⭐ 新增：时序与周期
  temporal:
    # 执行时序：sequential(顺序) / parallel(并行) / event(事件驱动)
    sequence: "sequential"
    
    # 执行周期
    schedule:
      type: "cron"  # cron / interval / manual / event
      value: "0 6 * * *"  # 每天6点
      
    # 依赖关系
    dependencies:
      before: []  # 前置Skill
      after: []   # 后置Skill
      
    # 超时设置
    timeout: 300  # 秒
    
    # 重试策略
    retry:
      max_attempts: 3
      backoff: "exponential"
```

---

## Agently组织模型

### 组织定义

```python
from agently import Agent, SkillCell

class ContentCreationOrgan(Agent):
    """内容创作器官 - 由多个Skill细胞组成"""
    
    # 组成细胞
    cells = [
        SkillCell("p0_scanner", schedule="0 6 * * *"),
        SkillCell("p1_evaluator", schedule="0 7 * * *"),
        SkillCell("content_generator"),
        SkillCell("platform_adapter"),
    ]
    
    # 经络连接 - 数据流
    meridians = {
        "perception": ["p0_scanner", "p1_evaluator"],
        "creation": ["p1_evaluator", "content_generator"],
        "distribution": ["content_generator", "platform_adapter"]
    }
    
    # 穴位 - 外部接口
    acupoints = {
        "input": "/api/content/input",
        "output": "/api/content/output",
        "status": "/api/content/status"
    }
```

---

## 经络运行时

### 数据经络
```
P0感知细胞 → 数据经络 → P1判断细胞 → 数据经络 → P2关系细胞
```

### 控制经络
```
调度中心 → 控制经络 → Skill细胞A
         → 控制经络 → Skill细胞B
```

---

## 器官分类体系

| 器官 | 功能 | 组成细胞 |
|------|------|----------|
| **感知器官** | 信息采集 | P0象限4细胞 |
| **判断器官** | 价值评估 | P1象限4细胞 |
| **关系器官** | 互动建立 | P2象限4细胞 |
| **进化器官** | 策略优化 | P3进化细胞 |
| **发布器官** | 内容分发 | 平台连接器细胞 |
| **记忆器官** | 知识存储 | 短期/长期记忆细胞 |

---

## 穴位接口标准

### 输入穴位
```python
@app.post("/acupoint/{organ}/{cell}/input")
async def cell_input(organ: str, cell: str, data: dict):
    """向指定细胞注入数据"""
    pass
```

### 输出穴位
```python
@app.get("/acupoint/{organ}/{cell}/output")
async def cell_output(organ: str, cell: str):
    """获取细胞输出"""
    pass
```

### 状态穴位
```python
@app.get("/acupoint/{organ}/{cell}/status")
async def cell_status(organ: str, cell: str):
    """查询细胞状态"""
    pass
```

---

## 时序编排示例

### Daily Sync 经络运行图

```
06:00  督脉启动 (主循环)
       ↓
06:00  手太阴肺经 (P0感知)
       ├─ Q1P0细胞激活
       ├─ Q2P0细胞激活
       ├─ Q3P0细胞激活
       └─ Q4P0细胞激活
       ↓
07:00  足阳明胃经 (P1判断)
       ├─ Q1P1细胞激活
       ├─ Q2P1细胞激活
       ├─ Q3P1细胞激活
       └─ Q4P1细胞激活
       ↓
08:00  手少阴心经 (P2关系)
       └─ 关系细胞群激活
       ↓
02:00  足厥阴肝经 (P3进化)
       └─ 进化细胞群激活
```

---

## 实现建议

### 1. Skill细胞化改造
- 为每个Skill添加`temporal`时序配置
- 标准化输入/输出接口
- 资源依赖声明化

### 2. Agently组织层
- 创建器官级Agent类
- 定义经络连接规则
- 暴露穴位接口

### 3. 经络运行时
- 实现异步消息总线
- 支持时序编排
- 监控细胞健康状态

### 4. 穴位网关
- 统一API网关
- 权限控制
- 流量监控

---

## 下一步

1. **Skill时序化**：为现有Skill添加周期配置
2. **Agently集成**：引入Agently框架
3. **经络实现**：构建消息总线
4. **穴位暴露**：开放API接口

请确认方向，我制定详细实施计划。
