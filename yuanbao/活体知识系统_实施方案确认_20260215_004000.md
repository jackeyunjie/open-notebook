# 活体知识系统 - 实施方案确认

## 方案选择：A. 嵌入式启动 ✅

**决策理由：**
- 复用现有 SurrealDB 基础设施
- 在 Notebook UI 中直接管理活体系统
- 与现有 Skill 系统无缝集成
- 降低部署复杂度

---

## 实施确认

| 确认项 | 选择 | 说明 |
|--------|------|------|
| 部署方式 | **A. 嵌入式** | 挂载 /living 路由 |
| 数据库 | **SurrealDB** | 复用现有端口8000 |
| 启动时机 | **立即** | 确认后立即编码 |

---

## 创建文件清单

| 文件 | 路径 | 功能 |
|------|------|------|
| launcher.py | `open_notebook/skills/living/launcher.py` | 系统启动器 |
| living.py | `api/routers/living.py` | REST API 路由 |
| database_living.py | `open_notebook/skills/living/database_living.py` | SurrealDB 集成 |

---

## 集成点

### 1. API 路由挂载
```python
# api/main.py 中添加
from api.routers import living

app.include_router(
    living.router,
    prefix="/living",
    tags=["living-system"]
)
```

### 2. 启动时初始化
```python
# api/main.py startup 事件
@app.on_event("startup")
async def startup():
    # 现有初始化...
    
    # 新增：启动活体系统
    from open_notebook.skills.living.launcher import LivingSystemLauncher
    app.state.living_system = LivingSystemLauncher()
    await app.state.living_system.launch()
```

### 3. SurrealDB 表设计
```sql
-- 细胞状态表
DEFINE TABLE cell_states SCHEMAFULL;
DEFINE FIELD cell_id ON cell_states TYPE string;
DEFINE FIELD skill_type ON cell_states TYPE string;
DEFINE FIELD state ON cell_states TYPE string;
DEFINE FIELD metabolism ON cell_states TYPE object;
DEFINE FIELD last_activation ON cell_states TYPE datetime;

-- 经络流量表
DEFINE TABLE meridian_flows SCHEMAFULL;
DEFINE FIELD meridian_name ON meridian_flows TYPE string;
DEFINE FIELD packet_count ON meridian_flows TYPE int;
DEFINE FIELD avg_latency_ms ON meridian_flows TYPE float;
```

---

## API 端点预览

| 方法 | 端点 | 功能 |
|------|------|------|
| GET | `/living/health` | 系统健康检查 |
| GET | `/living/organs` | 列出所有器官 |
| GET | `/living/organs/{name}/state` | 获取器官状态 |
| POST | `/living/organs/{name}/activate` | 激活器官 |
| GET | `/living/meridians/flows` | 经络流量统计 |
| POST | `/living/rhythm/trigger` | 手动触发节律 |

---

## 前端集成

在 IP指挥中心 页面添加：
- **活体系统状态面板** - 显示器官健康度
- **经络流量可视化** - 实时数据流动
- **节律控制** - 手动触发/暂停

---

## 实施步骤

1. **创建 database_living.py** - SurrealDB 连接
2. **创建 launcher.py** - 系统启动器
3. **创建 api/routers/living.py** - API 路由
4. **修改 api/main.py** - 集成启动
5. **测试验证** - 调用 /living/health

---

## 确认指令

**请回复确认：**
- "确认实施" - Claude 立即开始编码
- "调整方案" - 修改后重新确认
- "稍后实施" - 暂停，先做其他事
